<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Command Line | Watchman</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Watchman"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="The `watchman` executable contains both the client and the server components"><meta data-react-helmet="true" property="og:description" content="The `watchman` executable contains both the client and the server components"><meta data-react-helmet="true" property="og:url" content="https://facebook.github.io/watchman//watchman/docs/cli-options">

<link data-react-helmet="true" rel="shortcut icon" href="/watchman/img/favicon.png">


<link rel="stylesheet" href="/watchman/styles.fee8cdf5.css">


<link rel="preload" href="/watchman/styles.4c651cb6.js" as="script">

<link rel="preload" href="/watchman/runtime~main.74504f9e.js" as="script">

<link rel="preload" href="/watchman/main.f280eb02.js" as="script">

<link rel="preload" href="/watchman/1.ca01a91e.js" as="script">

<link rel="preload" href="/watchman/69.11c468f6.js" as="script">

<link rel="preload" href="/watchman/d6764f29.91fb97a4.js" as="script">

<link rel="preload" href="/watchman/17896441.fe0d8ff1.js" as="script">

<link rel="preload" href="/watchman/39e3b2a5.d647fff5.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/watchman/"><img class="navbar__logo" src="/watchman/img/logo.png" alt="Watchman Logo"><strong class="navbar__title">Watchman</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/watchman/docs/install">Docs</a><a class="navbar__item navbar__link" href="/watchman/docs/support">Support</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/watchman">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/watchman/"><img class="navbar__logo" src="/watchman/img/logo.png" alt="Watchman Logo"><strong class="navbar__title">Watchman</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/watchman/docs/install">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/support">Support</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/watchman">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/watchman/img/logo.png" alt="Watchman Logo"><strong>Watchman</strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Installation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/release-notes">Release Notes</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Invocation</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/watchman/docs/cli-options">Command Line</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/watchman-make">watchman-make</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/watchman-wait">watchman-wait</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/watchman-replicate-subscription">watchman-replicate-subscription</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/cppclient">C++ Client</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/nodejs">NodeJS</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/config">Configuration Files</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/socket-interface">Socket Interface</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Compatibility</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/compatibility">Compatibility Rules</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/capabilities">Capabilities</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Commands</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/find">find</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/flush-subscriptions">flush-subscriptions</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/get-config">get-config</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/get-sockname">get-sockname</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/list-capabilities">list-capabilities</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/log">log</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/log-level">log-level</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/query">query</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/shutdown-server">shutdown-server</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/since">since</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/state-enter">state-enter</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/state-leave">state-leave</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/subscribe">subscribe</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/trigger">trigger</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/trigger-del">trigger-del</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/trigger-list">trigger-list</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/unsubscribe">unsubscribe</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/version">version</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/watch">watch</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/watch-del">watch-del</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/watch-del-all">watch-del-all</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/watch-list">watch-list</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/watch-project">watch-project</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Queries</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/clockspec">Clockspec</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/file-query">File Queries</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/simple-query">Simple Pattern Syntax</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/scm-query">Source Control Aware Queries</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Expressions Terms</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/allof">allof</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/anyof">anyof</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/dirname">dirname &amp; idirname</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/empty">empty</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/exists">exists</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/match">match &amp; imatch</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/name">name &amp; iname</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/not">not</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/pcre">pcre &amp; ipcre</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/exp-since">since</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/size">size</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/suffix">suffix</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/type">type</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Internals</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/bser">BSER Binary Protocol</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/casefolding">Case-Insensitivity</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/contributing">Contributing</a></li><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/cookies">Query Synchronization</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/watchman/docs/troubleshooting">Troubleshooting</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Command Line</h1></header><div class="markdown"><p>The <code>watchman</code> executable contains both the client and the server components
of the watchman service.</p><p>By default, when <code>watchman</code> is run, it will attempt to communicate with your
existing server instance (each user has their own persistent process), and will
attempt to start it if it doesn&#x27;t exist.</p><p>There are some options that affect how <code>watchman</code> will locate the server, some
options that affect only the client and some others that affect only the
server.  Since all of the options are understood by the same executable we&#x27;ve
broken those out into sections of their own to make it clearer when they apply.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="quick-note-on-default-locations"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#quick-note-on-default-locations" title="Direct link to heading">#</a>Quick note on default locations</h2><p>Watchman will prefer to resolve your user name from the <code>$USER</code> environmental
variable, or <code>$LOGNAME</code> if <code>$USER</code> was not set.  If neither are set watchman
will look it up from the system using <code>getpwuid(getuid())</code>.  When we refer to
<code>&lt;USER&gt;</code> in this documentation we mean the result of this resolution.</p><p>In some cases Watchman will need to create files in a temporary location.
Watchman will resolve this temporary location by looking at the <code>$TMPDIR</code>
environmental variable, or <code>$TMP</code> if <code>$TMPDIR</code> was not set.  If neither are set
watchman will use <code>/tmp</code>.  When we refer to <code>&lt;TMPDIR&gt;</code> in this documentation we
mean the result of this resolution.</p><p>Watchman tracks its persistent state in a location that we refer to as the
<code>&lt;STATEDIR&gt;</code> in this documentation.</p><p><em>Since 3.1.</em></p><p>The <code>STATEDIR</code> defaulted to <code>&lt;PREFIX&gt;/var/run/watchman</code>.  You can change this
default when you build watchman by using the configure option
<code>--enable-statedir</code>.</p><p>Earlier versions of Watchman didn&#x27;t have a default statedir and would instead
use the <code>&lt;TMPDIR&gt;</code> for this state.  We switched away from that because some
environments randomize the <code>&lt;TMPDIR&gt;</code> location and this made it difficult for
clients to locate the Watchman service.</p><p><em>Since 3.8.</em></p><p>The <code>STATEDIR</code> defaults to <code>&lt;PREFIX&gt;/var/run/watchman/&lt;USER&gt;-state</code>.  You can
change this default when you build watchman by using the configure option
<code>--enable-statedir</code>; the configure option replaces the
<code>&lt;PREFIX&gt;/var/run/watchman</code> portion of this string.  If you specify
<code>--disable-statedir</code> then that portion of the string will be computed from the
<code>&lt;TMPDIR&gt;</code> location.</p><p>Watchman will create the <code>&lt;USER&gt;-state</code> portion if it does not exist, and will
perform some permission and ownership checks to reduce the risk of untrusted
users placing files in this location.  If those checks are not satisfied,
watchman will refuse to start.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="locating-the-service"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#locating-the-service" title="Direct link to heading">#</a>Locating the service</h2><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> -U, --sockname=PATH   Specify alternate sockname</span></div></code></pre></div><p>The default location for sockname will be <code>&lt;STATEDIR&gt;/&lt;USER&gt;</code>.  Older versions
of Watchman would default to <code>&lt;TMPDIR&gt;/.watchman.&lt;USER&gt;</code>, depending on how
it was configured.</p><p>If you are building a client to access the service programmatically, we
recommend that you invoke <a href="get-sockname">watchman get-sockname</a> to discover the path that the client and
server would use.  This has the side effect of spawning the service for you if
it isn&#x27;t already running.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="client-options"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#client-options" title="Direct link to heading">#</a>Client Options</h2><p>The <code>watchman</code> executable will attempt to start the service if there is no
response on the socket specified above.  In some cases it is desirable to avoid
starting the service if it isn&#x27;t running:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> --no-spawn            Don&#x27;t spawn service if it is not already running.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                       Will try running the command in client mode if</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                       possible.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> --no-local            When no-spawn is enabled, don&#x27;t use client mode</span></div></code></pre></div><p>Client mode implements the <a href="find">watchman find command</a> as an immediate search.</p><p>These options control how the client talks to the server:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> -p, --persistent           Persist and wait for further responses</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     --server-encoding=ARG  CLI&lt;-&gt;server encoding. json or bser.</span></div></code></pre></div><p>Persistent connections have relatively limited use with the CLI, but can be
useful to connect ad-hoc to the service to receive logging information (See
<a href="log-level">log-level</a>).</p><p>The server encoding option controls how requests and responses are formatted
when talking to the server.  You generally shouldn&#x27;t need to worry about this.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="input-and-output"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#input-and-output" title="Direct link to heading">#</a>Input and Output</h3><p>Most simple invocations of the CLI will pass a list of arguments:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ watchman </span><span class="token function" style="color:rgb(130, 170, 255)">watch</span><span class="token plain"> /path/to/dir</span></div></code></pre></div><p>This is turned into a request like this:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-json codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;watch&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/path/to/dir&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><p>and sent to the service using the <a href="socket-interface">Socket Interface</a>.</p><p>The response is received and then sent to the <code>stdout</code> stream formatted based on
the selected output-encoding:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">     --output-encoding=ARG  CLI output encoding. json (default) or bser</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     --no-pretty            Don&#x27;t pretty print JSON output (more efficient</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            when being processed by another program)</span></div></code></pre></div><p>Each command has its own response output but watchman will always include a
field named <code>error</code> if something about the request was not successful.  In case
of some protocol level errors (eg: connection was terminated) instead of
printing a response on <code>stdout</code>, an unstructured error message will be printed
to <code>stderr</code> and the process will exit with a non-zero exit status.</p><p>Instead of passing the request as command line parameters, you can send a JSON
representation on the <code>stdin</code> stream.  These invocations are all equivalent:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ watchman </span><span class="token function" style="color:rgb(130, 170, 255)">watch</span><span class="token plain"> /path/to/dir</span></div></code></pre></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ watchman -j </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;-</span><span class="token string" style="color:rgb(195, 232, 141)">EOT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">[&quot;watch&quot;, &quot;/path/to/dir&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOT</span></div></code></pre></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ watchman -j </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;[&quot;watch&quot;, &quot;/path/to/dir&quot;]&#x27;</span></div></code></pre></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;[&quot;watch&quot;, &quot;/path/to/dir&quot;]&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> watchman -j</span></div></code></pre></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;[&quot;watch&quot;, &quot;/path/to/dir&quot;]&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> cmd.json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ watchman -j </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> cmd.json</span></div></code></pre></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ watchman --json-command </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;-</span><span class="token string" style="color:rgb(195, 232, 141)">EOT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">[&quot;watch&quot;, &quot;/path/to/dir&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOT</span></div></code></pre></div><p><em>Since 3.8</em></p><p>The CLI now also recognizes BSER as a valid input stream when using the <code>-j</code>
option.  This will implicitly set <code>--server-encoding=bser</code> and
<code>--output-encoding=bser</code> if those options have not been set to something else.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="exit-status"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#exit-status" title="Direct link to heading">#</a>Exit Status</h2><p>The <code>watchman</code> binary will exit with a return code of 0 in most cases; this
indicates that the output it generated should be valid JSON.  To determine if
your command was successful, you need to parse the JSON and look for the
<code>error</code> field as described above.</p><p><code>watchman</code> will exit with a non-zero exit status in cases where something
low-level went wrong, such as protocol level errors (eg: connection was
terminated).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="server-options"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#server-options" title="Direct link to heading">#</a>Server Options</h2><p>These options are used when starting the server.  They are recognized by the
client and affect how it will start the server, but have no effect if the
server is already running.  To change the effective values of these options
for a running server, you will need to restart it (you can stop it by running
<a href="shutdown-server">watchman shutdown-server</a>).</p><p>By default, watchman will remember all watches and associated triggers and
reinstate them if the process is restarted.  This state is stored in the
<em>statefile</em>:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> --statefile=PATH      Specify path to file to hold watch and trigger state</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> -n, --no-save-state   Don&#x27;t save state between invocations</span></div></code></pre></div><p>The default location for statefile will be <code>&lt;STATEDIR&gt;/&lt;USER&gt;.state</code>.  Older
versions of watchman may store the state in <code>&lt;TMPDIR&gt;/.watchman.&lt;USER&gt;.state</code>,
depending on how they were configured.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">-o, --logfile=PATH   Specify path to logfile</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --log-level      set log verbosity (0 = off, default is 1, verbose = 2)</span></div></code></pre></div><p>The default location for logfile will be <code>&lt;STATEDIR&gt;/&lt;USER&gt;.log</code>.  Older
versions of watchman may store the logs in <code>&lt;TMPDIR&gt;/.watchman.&lt;USER&gt;.log</code>,
depending on how they were configured.</p><p>In some relatively uncommon circumstances, such as in test harnesses, you may
need to directly run the service without it putting itself into the background:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> -f, --foreground      Run the service in the foreground</span></div></code></pre></div><p><em>Since 4.6.</em></p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">     --inetd                Spawning from an inetd style supervisor</span></div></code></pre></div><p>When this flag is specified, watchman will use stdin as the listening socket
rather than attempting to set it up for itself.  This allows some other process
to maintain the socket and defer activating the watchman service until a client
is ready to connect.  This is most practically beneficial when used together
with <code>systemd</code>.</p><p><a href="https://github.com/facebook/watchman/commit/2985377eaf8c8538b28fae9add061b67991a87c2">This commit includes a sample configuration for systemd</a>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/watchman/edit/master/website/docs/cli-options.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/watchman/docs/release-notes"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Release Notes</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/watchman/docs/watchman-make"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">watchman-make »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#quick-note-on-default-locations" class="contents__link">Quick note on default locations</a></li><li><a href="#locating-the-service" class="contents__link">Locating the service</a></li><li><a href="#client-options" class="contents__link">Client Options</a><ul><li><a href="#input-and-output" class="contents__link">Input and Output</a></li></ul></li><li><a href="#exit-status" class="contents__link">Exit Status</a></li><li><a href="#server-options" class="contents__link">Server Options</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1Wg7"><img class="footer__logo" alt="Facebook Open Source Logo" src="/watchman/img/oss_logo.png"></a></div><div>Copyright © 2020 Facebook, Inc. Built with Docusaurus.</div></div></div></footer>
</div>

<script src="/watchman/styles.4c651cb6.js"></script>

<script src="/watchman/runtime~main.74504f9e.js"></script>

<script src="/watchman/main.f280eb02.js"></script>

<script src="/watchman/1.ca01a91e.js"></script>

<script src="/watchman/69.11c468f6.js"></script>

<script src="/watchman/d6764f29.91fb97a4.js"></script>

<script src="/watchman/17896441.fe0d8ff1.js"></script>

<script src="/watchman/39e3b2a5.d647fff5.js"></script>


</body>
</html>