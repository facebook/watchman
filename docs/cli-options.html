<html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>watchman | A file watching service</title><meta name="viewport" content="width=device-width"><meta property="og:title" content="watchman | A file watching service"><meta property="og:type" content="website"><meta property="og:url" content="http:&#x2f;&#x2f;facebook.github.io&#x2f;watchman&#x2f;index.html"><meta property="og:image" content="http:&#x2f;&#x2f;facebook.github.io&#x2f;watchman&#x2f;favicon.png"><meta property="og:description" content="A file watching service"><link rel="shortcut icon" href="&#x2f;watchman&#x2f;img&#x2f;favicon.png"><link rel="stylesheet" href="&#x2f;watchman&#x2f;css&#x2f;watchman.css"><script type="text&#x2f;javascript" src="&#x2f;&#x2f;use.typekit.net&#x2f;vqa1hcx.js"></script><script type="text&#x2f;javascript">try{Typekit.load();}catch(e){}</script></head><body><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="&#x2f;watchman&#x2f;">watchman</a><ul class="nav-site"><li><a href="&#x2f;watchman&#x2f;docs&#x2f;install.html" class="active">docs</a></li><li><a href="&#x2f;watchman&#x2f;support.html" class="">support</a></li><li><a href="http:&#x2f;&#x2f;github.com&#x2f;facebook&#x2f;watchman" class="">github</a></li></ul></div></div><section class="content wrap documentationContent"><div class="nav-docs"><div class="nav-docs-section"><h3>Installation</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;install.html">Installation</a></li></ul></div><div class="nav-docs-section"><h3>Invocation</h3><ul><li><a style="margin-left:0;" class="active" href="&#x2f;watchman&#x2f;docs&#x2f;cli-options.html">Command Line</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;config.html">Configuration Files</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;socket-interface.html">Socket Interface</a></li></ul></div><div class="nav-docs-section"><h3>Compatibility</h3><ul></ul></div><div class="nav-docs-section"><h3>Commands</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;clock.html">clock</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;find.html">find</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;get-config.html">get-config</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;get-sockname.html">get-sockname</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;log.html">log</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;log-level.html">log-level</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;query.html">query</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;shutdown-server.html">shutdown-server</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;since.html">since</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;subscribe.html">subscribe</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;trigger.html">trigger</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;trigger-del.html">trigger-del</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;trigger-list.html">trigger-list</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;unsubscribe.html">unsubscribe</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;version.html">version</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;watch.html">watch</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;watch-del.html">watch-del</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;watch-del-all.html">watch-del-all</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;watch-list.html">watch-list</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;watch-project.html">watch-project</a></li></ul></div><div class="nav-docs-section"><h3>Queries</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;clockspec.html">Clockspec</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;file-query.html">File Queries</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;simple-query.html">Simple Pattern Syntax</a></li></ul></div><div class="nav-docs-section"><h3>Internals</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;bser.html">BSER Binary Protocol</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;casefolding.html">Case-Insensitivity</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;contributing.html">Contributing</a></li><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;cookies.html">Query Synchronization</a></li></ul></div><div class="nav-docs-section"><h3>Troubleshooting</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;troubleshooting.html">Troubleshooting</a></li></ul></div><div class="nav-docs-section"><h3>Compabitility</h3><ul><li><a style="margin-left:0;" class="" href="&#x2f;watchman&#x2f;docs&#x2f;compatibility.html">Compatibility Rules</a></li></ul></div></div><div class="inner-content"><h1>Command Line</h1><div><p>The <code>watchman</code> executable contains both the client and the server components
of the watchman service.</p><p>By default, when <code>watchman</code> is run, it will attempt to communicate with your
existing server instance (each user has their own persistent process), and will
attempt to start it if it doesn&#x27;t exist.</p><p>There are some options that affect how <code>watchman</code> will locate the server, some
options that affect only the client and some others that affect only the
server.  Since all of the options are understood by the same executable we&#x27;ve
broken those out into sections of their own to make it clearer when they apply.</p><h2><a class="anchor" name="quick-note-on-default-locations"></a>Quick note on default locations <a class="hash-link" href="#quick-note-on-default-locations">#</a></h2><p>Watchman will prefer to resolve your user name from the <code>$USER</code> environmental
variable, or <code>$LOGNAME</code> if <code>$USER</code> was not set.  If neither are set watchman
will look it up from the system using <code>getpwuid(getuid())</code>.  When we refer to
<code>&lt;USER&gt;</code> in this documentation we mean the result of this resolution.</p><p>In some cases Watchman will need to create files in a temporary location.
Watchman will resolve this temporary location by looking at the <code>$TMPDIR</code>
environmental variable, or <code>$TMP</code> if <code>$TMPDIR</code> was not set.  If neither are set
watchman will use <code>&#x2f;tmp</code>.  When we refer to <code>&lt;TMPDIR&gt;</code> in this documentation we
mean the result of this resolution.</p><h2><a class="anchor" name="locating-the-service"></a>Locating the service <a class="hash-link" href="#locating-the-service">#</a></h2><div class="prism language-javascript"> <span class="token operator">-</span>U<span class="token punctuation">,</span> <span class="token operator">--</span>sockname<span class="token operator">=</span>PATH   Specify alternate sockname</div><p>If you configured watchman using <code>--enable-statedir=&lt;STATEDIR&gt;</code> the
default location for sockname will be <code>&lt;STATEDIR&gt;&#x2f;&lt;USER&gt;</code>, otherwise it will be
<code>&lt;TMPDIR&gt;&#x2f;.watchman.&lt;USER&gt;</code>.</p><p>If you are building a client to access the service programmatically, we
recommend that you invoke <a href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;get-sockname.html" target="">watchman get-sockname</a> to discover the path that the client and
server would use.  This has the side effect of spawning the service for you if
it isn&#x27;t already running.</p><h2><a class="anchor" name="client-options"></a>Client Options <a class="hash-link" href="#client-options">#</a></h2><p>The <code>watchman</code> executable will attempt to start the service if there is no
response on the socket specified above.  In some cases it is desirable to avoid
starting the service if it isn&#x27;t running:</p><div class="prism language-javascript"> <span class="token operator">--</span>no<span class="token operator">-</span>spawn            Don&#x27;t spawn service <span class="token keyword">if</span> it is not already running<span class="token punctuation">.</span>
                       Will <span class="token keyword">try</span> running the command <span class="token keyword">in</span> client mode <span class="token keyword">if</span>
                       possible<span class="token punctuation">.</span>
 <span class="token operator">--</span>no<span class="token operator">-</span>local            When no<span class="token operator">-</span>spawn is enabled<span class="token punctuation">,</span> don&#x27;t use client mode</div><p>Client mode implements the <a href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;find.html" target="">watchman find command</a> as an immediate search.</p><p>These options control how the client talks to the server:</p><div class="prism language-javascript"> <span class="token operator">-</span>p<span class="token punctuation">,</span> <span class="token operator">--</span>persistent           Persist and wait <span class="token keyword">for</span> further responses
     <span class="token operator">--</span>server<span class="token operator">-</span>encoding<span class="token operator">=</span>ARG  CLI&lt;<span class="token operator">-</span><span class="token operator">&gt;</span>server encoding<span class="token punctuation">.</span> json or bser<span class="token punctuation">.</span></div><p>Persistent connections have relatively limited use with the CLI, but can be
useful to connect ad-hoc to the service to receive logging information (See
<a href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;log-level.html" target="">log-level</a>).</p><p>The server encoding option controls how requests and responses are formatted
when talking to the server.  You generally shouldn&#x27;t need to worry about this.</p><h3><a class="anchor" name="input-and-output"></a>Input and Output <a class="hash-link" href="#input-and-output">#</a></h3><p>Most simple invocations of the CLI will pass a list of arguments:</p><div class="prism language-javascript">$ watchman watch <span class="token operator">&#x2f;</span>path<span class="token operator">&#x2f;</span>to<span class="token operator">&#x2f;</span>dir</div><p>This is turned into a request like this:</p><div class="prism language-javascript"><span class="token punctuation">[</span><span class="token string">&quot;watch&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#x2f;path&#x2f;to&#x2f;dir&quot;</span><span class="token punctuation">]</span></div><p>and sent to the service using the <a href="&#x2f;watchman&#x2f;docs&#x2f;socket-interface.html" target="">Socket Interface</a>.</p><p>The response is received and then sent to the <code>stdout</code> stream formatted based on
the selected output-encoding:</p><div class="prism language-javascript">     <span class="token operator">--</span>output<span class="token operator">-</span>encoding<span class="token operator">=</span>ARG  CLI output encoding<span class="token punctuation">.</span> json <span class="token punctuation">(</span>default<span class="token punctuation">)</span> or bser
     <span class="token operator">--</span>no<span class="token operator">-</span>pretty            Don&#x27;t pretty print JSON output <span class="token punctuation">(</span>more efficient
                            when being processed by another program<span class="token punctuation">)</span></div><p>Each command has its own response output but watchman will always include a
field named <code>error</code> if something about the request was not successful.  In case
of some protocol level errors (eg: connection was terminated) instead of
printing a response on <code>stdout</code>, an unstructured error message will be printed
to <code>stderr</code> and the process will exit with a non-zero exit status.</p><p>Instead of passing the request as command line parameters, you can send a JSON
representation on the <code>stdin</code> stream.  These invocations are all equivalent:</p><div class="prism language-javascript">$ watchman watch <span class="token operator">&#x2f;</span>path<span class="token operator">&#x2f;</span>to<span class="token operator">&#x2f;</span>dir</div><div class="prism language-javascript">$ watchman <span class="token operator">-</span>j &lt;&lt;<span class="token operator">-</span>EOT
<span class="token punctuation">[</span><span class="token string">&quot;watch&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#x2f;path&#x2f;to&#x2f;dir&quot;</span><span class="token punctuation">]</span>
EOT</div><div class="prism language-javascript">$ echo <span class="token string">&#x27;[&quot;watch&quot;, &quot;&#x2f;path&#x2f;to&#x2f;dir&quot;]&#x27;</span> <span class="token operator">|</span> watchman <span class="token operator">-</span>j</div><div class="prism language-javascript">$ echo <span class="token string">&#x27;[&quot;watch&quot;, &quot;&#x2f;path&#x2f;to&#x2f;dir&quot;]&#x27;</span> <span class="token operator">&gt;</span> cmd<span class="token punctuation">.</span>json
$ watchman <span class="token operator">-</span>j &lt; cmd<span class="token punctuation">.</span>json</div><div class="prism language-javascript">$ watchman <span class="token operator">--</span>json<span class="token operator">-</span>command &lt;&lt;<span class="token operator">-</span>EOT
<span class="token punctuation">[</span><span class="token string">&quot;watch&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#x2f;path&#x2f;to&#x2f;dir&quot;</span><span class="token punctuation">]</span>
EOT</div><h2><a class="anchor" name="exit-status"></a>Exit Status <a class="hash-link" href="#exit-status">#</a></h2><p>The <code>watchman</code> binary will exit with a return code of 0 in most cases; this
indicates that the output it generated should be valid JSON.  To determine if
your command was successful, you need to parse the JSON and look for the
<code>error</code> field as described above.</p><p><code>watchman</code> will exit with a non-zero exit status in cases where something
low-level went wrong, such as protocol level errors (eg: connection was
terminated).</p><h2><a class="anchor" name="server-options"></a>Server Options <a class="hash-link" href="#server-options">#</a></h2><p>These options are used when starting the server.  They are recognized by the
client and affect how it will start the server, but have no effect if the
server is already running.  To change the effective values of these options
for a running server, you will need to restart it (you can stop it by running
<a href="&#x2f;watchman&#x2f;docs&#x2f;cmd&#x2f;shutdown-server.html" target="">watchman shutdown-server</a>).</p><p>By default, watchman will remember all watches and associated triggers and
reinstate them if the process is restarted.  This state is stored in the
<em>statefile</em>:</p><div class="prism language-javascript"> <span class="token operator">--</span>statefile<span class="token operator">=</span>PATH      Specify path to file to hold watch and trigger state
 <span class="token operator">-</span>n<span class="token punctuation">,</span> <span class="token operator">--</span>no<span class="token operator">-</span>save<span class="token operator">-</span>state   Don&#x27;t save state between invocations</div><p>If you configured watchman using <code>--enable-statedir=&lt;STATEDIR&gt;</code> the
default location for statefile will be <code>&lt;STATEDIR&gt;&#x2f;&lt;USER&gt;.state</code>, otherwise it
will be <code>&lt;TMPDIR&gt;&#x2f;.watchman.&lt;USER&gt;.state</code>.</p><div class="prism language-javascript"><span class="token operator">-</span>o<span class="token punctuation">,</span> <span class="token operator">--</span>logfile<span class="token operator">=</span>PATH   Specify path to logfile
    <span class="token operator">--</span>log<span class="token operator">-</span>level      <span class="token keyword">set</span> log verbosity <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">=</span> off<span class="token punctuation">,</span> default is <span class="token number">1</span><span class="token punctuation">,</span> verbose <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span></div><p>If you configured watchman using <code>--enable-statedir=&lt;STATEDIR&gt;</code> the
default location for logfile will be <code>&lt;STATEDIR&gt;&#x2f;&lt;USER&gt;.log</code>, otherwise it
will be <code>&lt;TMPDIR&gt;&#x2f;.watchman.&lt;USER&gt;.log</code>.</p><p>In some relatively uncommon circumstances, such as in test harnesses, you may
need to directly run the service without it putting itself into the background:</p><div class="prism language-javascript"> <span class="token operator">-</span>f<span class="token punctuation">,</span> <span class="token operator">--</span>foreground      Run the service <span class="token keyword">in</span> the foreground</div></div><div class="docs-prevnext"></div></div></section><footer class="wrap"><div class="right">Â© 2012-2015 Facebook Inc.</div></footer></div><div id="fb-root"></div><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-387204-10', 'facebook.github.io');
            ga('send', 'pageview');

            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)
            ){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
          </script></body></html>